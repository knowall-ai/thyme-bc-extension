= Troubleshooting Guide
:toc:

== Common Issues

[cols="1,2", options="header"]
|===
| Problem | Solution

| `404 Not Found` when calling API
| Extension not deployed or wrong environment. Verify deployment in BC Admin Center → Extensions.

| `401 Unauthorized` error
| Azure AD token expired or invalid. Re-authenticate with `az login` or check client credentials.

| `403 Forbidden` on API call
| Missing API permissions. Grant `Dynamics 365 Business Central → API.ReadWrite.All` in Azure Portal.

| Symbols download fails in VS Code
| Check BC environment is accessible. Run `AL: Clear Credentials Cache` and retry.

| Build fails with missing dependencies
| Run `AL: Download Symbols` to fetch latest BC symbols.

| Extension won't publish
| Check `app.json` version is incremented. BC won't reinstall same version.

| GitHub Action fails at `Install-Module`
| Windows runner issue. Ensure `runs-on: windows-latest` in workflow.

| `New-BcAuthContext` returns null
| Client secret expired. Create new secret in Azure AD app registration.

| API returns empty results
| Check company context. Ensure `BC_COMPANY` matches a valid company name.

| `syncMode ForceSync` error
| Breaking schema changes. May need to uninstall extension first, then reinstall.

| Deployment works but API not visible
| Wait 1-2 minutes for BC to register new API endpoints after deployment.

| `Job` table not found in symbols
| Using wrong BC version. Check `platform` and `application` versions in `app.json`.

| `Compile-AppInBcContainer : A parameter cannot be found that matches parameter name 'authContext'`
| Wrong function for BC Online. Use `Download-Artifacts` to get `alc.exe`, download symbols via dev API, compile with `alc.exe`, then deploy with `Publish-PerTenantExtensionApps`.

| `Publish-BcContainerApp` fails for BC SaaS
| Use `Publish-PerTenantExtensionApps` for BC Online environments instead of `Publish-BcContainerApp`.

| `401 Unauthorized` with `Authentication_InvalidCredentials` when publishing
| Azure AD app missing `Automation.ReadWrite.All` permission. Add this in Azure Portal → App registrations → API permissions → Dynamics 365 Business Central → Application permissions → `Automation.ReadWrite.All`, then grant admin consent.

| `-schemaSyncMode ForceSync` validation error
| Use `-schemaSyncMode Force` instead. Valid values are `Add` or `Force`.
|===

== Getting Help

* https://github.com/knowall-ai/thyme-bc-extension/issues[Open an Issue]
* https://learn.microsoft.com/en-us/dynamics365/business-central/dev-itpro/developer/devenv-develop-custom-api[Microsoft BC API Docs]
